prefix=@prefix@
exec_prefix=@exec_prefix@
srcdir=@srcdir@
mandir=@mandir@
INSTALL=@INSTALL@
INSTALL_PROGRAM=@INSTALL_PROGRAM@
INSTALL_DATA=@INSTALL_DATA@

all:
	(cd support ; $(MAKE) all)
	(cd src ; $(MAKE) all)
	(cd src/ftpck ; $(MAKE) all)
	if [ ! -d bin ]; then mkdir bin; fi
	rm -f bin/ftpd bin/ftpshut bin/ftpcount bin/ftpwho bin/ckconfig bin/ftprestart bin/ftpck
	@CPLN@ src/ftpd bin
	@CPLN@ src/ftpshut bin
	@CPLN@ src/ftpcount bin
	@CPLN@ src/ftpcount bin/ftpwho
	@CPLN@ src/ckconfig bin
	@CPLN@ src/ftprestart bin
	@CPLN@ src/ftpck/ftpck bin
	size bin/ftpd bin/ftpshut bin/ftpcount bin/ftpwho bin/ckconfig bin/ftprestart bin/ftpck
clean:
	(cd support ; $(MAKE) clean)
	(cd src ; $(MAKE) clean)
	(cd src/ftpck ; $(MAKE) clean)
	-rm -rf bin
distclean: clean
	(cd support ; $(MAKE) distclean)
	(cd src ; $(MAKE) distclean)
	(cd src/ftpck ; $(MAKE) distclean)
	-rm -f *~
	-rm -f src/*~
	-rm -f support/*~
	-rm -f doc/*~
	-rm -f util/*~
	-rm -f config.log config.status config.cache Makefile config.h
install: all
	@echo installing binaries.
	-@mkdir -p @sbindir@
	-@mkdir -p @bindir@
	@INSTALL_PROGRAM@ -o bin -g bin -m 755 bin/ftpd @sbindir@/BeroFTPD
	@INSTALL_PROGRAM@ -o bin -g bin -m 755 bin/ftpshut @sbindir@/ftpshut
	@INSTALL_PROGRAM@ -o bin -g bin -m 755 bin/ftprestart @sbindir@/ftprestart
	@INSTALL_PROGRAM@ -o bin -g bin -m 755 bin/ftpcount @bindir@/ftpcount
	@INSTALL_PROGRAM@ -o bin -g bin -m 755 bin/ftpwho @bindir@/ftpwho
	@INSTALL_PROGRAM@ -o bin -g bin -m 755 bin/ckconfig @sbindir@/ckconfig
	@INSTALL_PROGRAM@ -o bin -g bin -m 755 bin/ftpck @sbindir@/ftpck
	@echo installing manpages.
	-@mkdir -p $(mandir)
	@INSTALL_DATA@ -o bin -g bin -m 644 doc/ftpd.8 $(mandir)/man8/ftpd.8
	@INSTALL_DATA@ -o bin -g bin -m 644 doc/ftpcount.1 $(mandir)/man1/ftpcount.1
	@INSTALL_DATA@ -o bin -g bin -m 644 doc/ftpwho.1 $(mandir)/man1/ftpwho.1
	@INSTALL_DATA@ -o bin -g bin -m 644 doc/ftpshut.8 $(mandir)/man8/ftpshut.8
	@INSTALL_DATA@ -o bin -g bin -m 644 doc/ftpaccess.5 $(mandir)/man5/ftpaccess.5
	@INSTALL_DATA@ -o bin -g bin -m 644 doc/ftphosts.5 $(mandir)/man5/ftphosts.5
	@INSTALL_DATA@ -o bin -g bin -m 644 doc/ftpconversions.5 $(mandir)/man5/ftpconversions.5
	@INSTALL_DATA@ -o bin -g bin -m 644 doc/ftpservers.5 $(mandir)/man5/ftpservers.5
	@INSTALL_DATA@ -o bin -g bin -m 644 doc/xferlog.5 $(mandir)/man5/xferlog.5
	@INSTALL_DATA@ -o bin -g bin -m 644 doc/ftprestart.8 $(mandir)/man8/ftprestart.8
	@if test ! -f @CONFDIR@/ftpaccess; then echo "Since you didn't have a ftpaccess file, the sample has been"; echo "installed to @CONFDIR@/ftpaccess."; echo "You will probably want to edit it."; @INSTALL@ -c -o bin -g bin -m 644 doc/examples/ftpaccess @CONFDIR@/ftpaccess; fi
	@if test ! -f @CONFDIR@/ftpconversions; then echo "Since you didn't have a ftpconversions file, the sample has been"; echo "installed to @CONFDIR@/ftpconversions."; echo "You will probably want to edit it."; @INSTALL@ -c -o bin -g bin -m 644 doc/examples/ftpconversions @CONFDIR@/ftpconversions; fi
