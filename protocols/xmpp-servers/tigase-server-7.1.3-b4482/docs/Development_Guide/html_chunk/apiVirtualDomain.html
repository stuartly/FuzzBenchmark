<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;13.&nbsp;API Description for Virtual Domains Management in the Tigase Server</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Development Guide"><link rel="up" href="index.html" title="Tigase Development Guide"><link rel="prev" href="genTigaseInstaller.html" title="Chapter&nbsp;12.&nbsp;Generating Tigase Installer"><link rel="next" href="stanzaLimitations.html" title="Chapter&nbsp;14.&nbsp;Stanza Limitations"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;13.&nbsp;API Description for Virtual Domains Management in the Tigase Server</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="genTigaseInstaller.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="stanzaLimitations.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="apiVirtualDomain"></a>Chapter&nbsp;13.&nbsp;API Description for Virtual Domains Management in the Tigase Server</h1></div></div></div><p>The purpose of this guide is to introduce vhost management in Tigase server. Please refer to the JavaDoc documentation for all specific details not covered in this guide. All interfaces are well documented and you can use existing implementation as an example code base and reference point. The VHost management files are located in the repository and you can browse them using the <a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/show/src/main/java/tigase/vhosts" target="_top">project tracker</a>.</p><p>Virtual hosts management in Tigase can be adjusted in many ways through the flexible API. The core elements of the virtual domains management is interface <a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostManager.java" target="_top">VHostManager</a> class. They are responsible for providing the virtual hosts information to the rest of the Tigase server components. In particular to the <a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/server/MessageRouter.java" target="_top">MessageRouter</a> class which controls how XMPP packets flow inside the server.</p><p>The class you most likely want to re-implement is <a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostJDBCRepository.java" target="_top">VHostJDBCRepository</a> used as a default virtual hosts storage and implementing the <a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostRepository.java" target="_top">VHostRepository</a> interface. You might need to have your own implementation in order to store and access virtual hosts in other than Tigase&#8217;s own data storage. This is especially important if you are going to modify the virtual domains list through systems other than Tigase.</p><p>The very basic virtual hosts storage is provided by <a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostItem.java" target="_top">VHostItem</a> class. This is read only storage and provides the server a bootstrap vhosts data at the first startup time when the database with virtual hosts is empty or is not accessible. Therefore it is advised that all <a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostItem.java" target="_top">VHostItem</a> implementations extend this class. The example code is provided in the <a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostJDBCRepository.java" target="_top">VHostJDBCRepository</a> file.</p><p>All components which may need virtual hosts information or want to interact with virtual hosts management subsystem should implement the <a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostListener.java" target="_top">VHostListener</a> interface. In some cases implementing this interface is necessary to receive packets for processing.</p><p>Virtual host information is carried out in 2 forms inside the Tigase server:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">As a <span class="strong"><strong>String</strong></span> value with the domain name</li><li class="listitem">As a <span class="strong"><strong><a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostItem.java" target="_top">VHostItem</a></strong></span> which contains all the domain information including the domain name, maximum number of users for this domain, whether the domain is enabled or disabled and so on. The JavaDoc documentation contains all the details about all available fields and usage.</li></ol></div><p>Here is a complete list of all interfaces and classes with a brief description for each of them:</p><div class="orderedlist"><a name="vhostManIfc"></a><ol class="orderedlist" type="1"><li class="listitem"><a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostManagerIfc.java" target="_top">VHostManagerIfc</a> - is an interface used to access virtual hosts information in all other server components. There is one default implementation of the interface: <a class="link" href="">VHostManager</a>.</li><li class="listitem"><a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostListener.java" target="_top">VHostListener</a> - is an interface which allows components to interact with the <a class="link" href="">VHostManager</a>. The interaction is in both ways. The VHostManager provides virtual hosts information to components and components provide some control data required to correctly route packets to components.</li><li class="listitem"><a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostRepository.java" target="_top">VHostRepository</a> - is an interface used to store and load virtual domains list from the database or any other storage media. There are 2 implementations for this interface: <a class="link" href="http://projects.tigase.org/server/trac/browser/trunk/src/main/java/tigase/vhosts/VhostConfigRepository.java" target="_top">VHostConfigRepository</a> which loads vhosts information for the configuration file and provides read-only storage and - <a class="link" href="">VHostJDBCRepository</a> class which extends <a class="link" href="http://projects.tigase.org/server/trac/browser/trunk/src/main/java/tigase/vhosts/VhostConfigRepository.java" target="_top">VHostConfigRepository</a> and allows for both - reading and saving virtual domains list. <code class="literal">VHostJDBCRepository</code> is loaded as a default repository by Tigase server.</li><li class="listitem"><a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostItem.java" target="_top">VHostItem</a> - is a class which allows for keeping all the virtual domain properties. Sometimes the domain name is not sufficient for data processing. The domain may be temporarily disabled, may have a limited number of users and so on. Instances of this class keep all the information about the domain which might be needed by the server components.</li><li class="listitem"><a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostManager.java" target="_top">VHostManager</a> - the default implementation of the VHostManagerIfc interface. It provides components with the virtual hosts information and manages the virtual hosts list. Processes ad-hoc commands for reloading, updating and removing domains.</li><li class="listitem"><a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VhostConfigRepository.java" target="_top">VHostConfirRepository</a> - a very basic implementation of the <a class="link" href="http://projects.tigase.org/server/trac/browser/trunk/src/main/java/tigase/vhosts/VHostRepository.java" target="_top">VHostRepository</a> for loading domains list from the configuration file.</li><li class="listitem"><a class="link" href="https://projects.tigase.org/projects/tigase-server/repository/revisions/master/entry/src/main/java/tigase/vhosts/VHostJDBCRepository.java" target="_top">VHostJDBCRepository</a> - the default implementation of the <a class="link" href="http://projects.tigase.org/server/trac/browser/trunk/src/main/java/tigase/vhosts/VHostRepository.java" target="_top">VHostRepository</a> loaded by Tigase server. It allows to read and store virtual domains list in the database accessible through UserRepository.</li></ol></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="genTigaseInstaller.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="stanzaLimitations.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;12.&nbsp;Generating Tigase Installer&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;14.&nbsp;Stanza Limitations</td></tr></table></div></body></html>