<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Mobile Optimizations</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Development Guide"><link rel="up" href="_experimental.html" title="Chapter&nbsp;8.&nbsp;Experimental"><link rel="prev" href="_experimental.html" title="Chapter&nbsp;8.&nbsp;Experimental"><link rel="next" href="boshsessioncache.html" title="Bosh Session Cache"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Mobile Optimizations</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_experimental.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;8.&nbsp;Experimental</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="boshsessioncache.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mobileoptimizations"></a>Mobile Optimizations</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_problem_description_2"></a>Problem Description</h3></div></div></div><p>In default configuration stanzas are sent to the client when processing is finished, but in mobile environment sending or receiving data drains battery due to use of the radio.</p><p>To save energy data should be sent to client only if it is important or client is waiting for it.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_solution"></a>Solution</h3></div></div></div><p>When mobile client is entering inactive state it notifies server about it by sending following stanza:</p><pre class="programlisting">&lt;iq type="set" id="xx"&gt;
&lt;mobile
  xmlns="http://tigase.org/protocol/mobile#v3"
  enable="true"/&gt;
&lt;/iq&gt;</pre><p>After receiving stanza server starts queuing stanza which should be send to mobile client. What kind of queued stanzas depends on the plugins used and in case of <span class="strong"><strong>Mobile v3</strong></span> presence stanzas are queued as well as message stanzas which are Message Carbons. Any other stanza (such as iq or plain messenge) is sent immediately to the client and every stanza from queue is also sent at this time.</p><p>When mobile client is entering active state it notifies server by sending following stanza:</p><pre class="programlisting">&lt;iq type="set" id="xx"&gt;
&lt;mobile
  xmlns="http://tigase.org/protocol/mobile#v3"
  enable="false"/&gt;
&lt;/iq&gt;</pre><p>After receiving stanza server sends all queued stanzas to the client.</p><p>Also all stanzas from queue will be sent if number of stanzas in queue will reach queue size limit. By default this limit is set to 50.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_queuing_algorithms"></a>Queuing Algorithms</h3></div></div></div><p>There are three mobile optimization plugins for Tigase:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="strong"><strong>Mobile v1</strong></span> - all presence stanzas are kept in queue</li><li class="listitem"><span class="strong"><strong>Mobile v2</strong></span> - only last presence from each source is kept in queue</li><li class="listitem"><span class="strong"><strong>Mobile v3</strong></span> - only last presence from each source is kept in queue, also Message Carbons are queued</li></ul></div><p>If you wish to activate you Mobile v1 plugin you need to send presented above with xmlns attribute value replaced with <span class="emphasis"><em><a class="link" href="http://tigase.org/protocol/mobile#v1" target="_top">http://tigase.org/protocol/mobile#v1</a></em></span></p><p>If you wish to activate you Mobile v2 plugin you need to send presented above with xmlns attribute value replaced with <span class="emphasis"><em><a class="link" href="http://tigase.org/protocol/mobile#v2" target="_top">http://tigase.org/protocol/mobile#v2</a></em></span></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_configuration_3"></a>Configuration</h3></div></div></div><p>Mentioned plugins are not activated by default thus additional entries in the init.properties are required:</p><p>+--sm-plugins=+mobile_v1,+mobile_v2,+mobile_v3</p><p><span class="strong"><strong>Only one of these plugins should be enabled</strong></span></p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_experimental.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="_experimental.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="boshsessioncache.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;8.&nbsp;Experimental&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Bosh Session Cache</td></tr></table></div></body></html>