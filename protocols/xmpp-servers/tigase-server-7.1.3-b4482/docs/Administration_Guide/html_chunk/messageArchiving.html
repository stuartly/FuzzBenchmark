<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Message Archiving Component</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Administration Guide"><link rel="up" href="loadComponent.html" title="Chapter&nbsp;8.&nbsp;Configuring the Tigase Server to Load a Component"><link rel="prev" href="_tigase_http_api.html" title="Tigase HTTP API"><link rel="next" href="amp0079.html" title="Advanced Message Processing - AMP XEP-0079"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Message Archiving Component</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_tigase_http_api.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;8.&nbsp;Configuring the Tigase Server to Load a Component</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="amp0079.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="messageArchiving"></a>Message Archiving Component</h2></div></div></div><p><span class="strong"><strong>NOTE: This component is incomplete and does not support all methods specified in XEP-0136</strong></span>
Tigase server supports many of the features in XEP-0136, however it is not yet in full compliance with the XEP. The reason for this is that it uses the archived message date as the thread id of message due to the face that some clients sens messages with no thread id (e.g. Psi, Psi+). Due to this fact it is also possible to query the component about messages without specifying thread ids. For now the component also stores bare JIDs of recipients.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_installation_2"></a>Installation</h3></div></div></div><p>The message archiving component is not included with the standard build of Tigase, and thus will need to be compiled or downloaded. Here are the two methods:</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_download"></a>Download</h4></div></div></div><p>The easiest way is to download the <a class="link" href="https://projects.tigase.org/attachments/download/3435/tigase-message-archiving-1.2.0-SNAPSHOT.jar" target="_top">tigase-message-archiving-1.2.0-SNAPSHOT.jar</a> file into your /jars directory.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_compile"></a>Compile</h4></div></div></div><p>The Tigase Message Archive component is kept in a separate repository from Tigase-server. It will compile in a similar manner though. Be sure you have Maven 3.0 or later installed. (to check use mvn version)
First, obtain a clone of the repository using the following command:</p><pre class="programlisting">$ git clone https://repository.tigase.org/git/message-archiving.git</pre><p>The repository will be downloaded to the /message-archiving/ directory.</p><pre class="screen">$cd message-archiving
/message-archiving$ mvn clean package</pre><p>Once Maven has finished compiling, go into the /target directory and you will find the required jar there. Move that to Tigase&#8217;s /jars folder and your component is ready to run.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_configuration_7"></a>Configuration</h3></div></div></div><p>To activate message archiving, place the following lines in the init.properties file:</p><pre class="programlisting">--comp-name-3=message-archive
--comp-class-3=tigase.archive.MessageArchiveComponent</pre><p>These two lines are the component required to be active. As with activating any component, be sure the component name and class match, and that the number is not used by another component.</p><pre class="screen">message-archive/archive-repo-uri=jdbc:mysql://localhost/messagearchivedb?user=test&amp;password=test</pre><p>This next line defines that message archives will be stored in a specific database, in this case messagearchivedb hosted on localhost. If this is blank, the archive will be stored in the default user repository.</p><pre class="screen">--sm-plugins=message-archive-xep-0136
sess-man/plugins-conf/message-archive-xep-0136/component-jid=archive@host.com</pre><p>The next line turns on the message archive plugin, while this is not always necessary, in order to configure extra options, this line is needed.
Finally, this line specifies the name for the component, if left blank the component&#8217;s JID will be message-archive@local-machine-name.</p><p><span class="strong"><strong>NOTE: Message tagging can take up considerable resources!</strong></span>
There are a high number of prepared statements which are used to process and archive messages as they go through the server, and you may experience an increase in resource use with the archive turned on. It is recommended to drecrease the repository connection pool to help balance server load from this component using the following line in init.properties:</p><pre class="programlisting">--data-repo-pool-size=5</pre><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nonBodyStore"></a>Saving Options</h4></div></div></div><p>By default, Tigase Message Archive will only store the message body with some metadata, this can exclude messages that are lacking a body.  If you decide you wish to save non-body elements within Message Archive, you can now can now configure this using the following line from init.properties:</p><pre class="screen">sess-man/plugins-conf/unified-archive/msg-archive-paths[s]=/message/body,/message/subject</pre><p>Where above will set the archive to store messages with &lt;body/&gt; or &lt;subject/&gt; elements.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Tip</h3><p>Enabling this for elements such as iq, or presence will quickly load the archive.  Configure this setting carefully!</p></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_usage_3"></a>Usage</h3></div></div></div><p>Now that we have the archive component running, how do we use it?  Currently, the only way to activate and modify the component is through XMPP stanzas.  Lets first begin by getting our default settings from the component:</p><pre class="programlisting">&lt;iq type='get' id='prefq'&gt;
  &lt;pref xmlns='urn:xmpp:archive'/&gt;
&lt;/iq&gt;</pre><p>It&#8217;s a short stanza, but it will tell us what we need to know, Note that you do not need a from or a to for this stanza. The result is as follows:</p><pre class="programlisting">&lt;iq type='result' id='prefq' to='admin@domain.com/cpu'&gt;
&lt;pref xmlns='urn:xmpp:archive'&gt;
&lt;auto save='false'/&gt;
&lt;default otr='forbid' muc-save="false" save="body"/&gt;
&lt;method use="prefer" type="auto"/&gt;
&lt;method use="prefer" type="local"/&gt;
&lt;method use="prefer" type="manual"/&gt;
&lt;/prefq&gt;
&lt;/iq&gt;</pre><p>See below for what these settings mean.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_xep_0136_field_values"></a>XEP-0136 Field Values</h4></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">&lt;auto/&gt;</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara"><span class="strong"><strong>Required Attributes</strong></span></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">save= Boolean turning archiving on or off</li></ul></div></li><li class="listitem"><p class="simpara"><span class="strong"><strong>Optional Settings</strong></span></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">scope= Determines scope of archiving, default is \'stream' which turns off after stream end, or may be \'global' which keeps auto save permanent,</li></ul></div></li></ul></div></dd><dt><span class="term">&lt;default/&gt;</span></dt><dd><p class="simpara">Default element sets default settings for OTR and save modes, includes an option for archive expiration.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara"><span class="strong"><strong>Required Attribures</strong></span></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p class="simpara">otr= Specifies setting for Off The Record mode. Available settings are:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem">approve The user MUST explicitly approve OTR communication.</li><li class="listitem">concede Communications MAY be OTR if requested by another user.</li><li class="listitem">forbid Communications MUST NOT be OTR.</li><li class="listitem">oppose Communications SHOULD NOT be OTR.</li><li class="listitem">prefer Communications SHOULD be OTR.</li><li class="listitem">require Communications MUST be OTR.</li></ul></div></li><li class="listitem"><p class="simpara">save= Specifies the portion of messages to archive, by default it is set to body.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem">body Archives only the items within the &lt;body/&gt; elements.</li><li class="listitem">message Archive the entire XML content of each message.</li><li class="listitem">stream Archive saves every byte of communication between server and client. (Not recommended, high resource use)</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara"><span class="strong"><strong>Optional Settings</strong></span></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">expire= Specifies after how many seconds should the server delete saved messages.</li></ul></div></li></ul></div></dd><dt><span class="term">&lt;item/&gt;</span></dt><dd><p class="simpara">The Item element specifies settings for a particular entity. These settings will override default settings for the specified JIDS.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara"><span class="strong"><strong>Required Attributes</strong></span></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">JID= The Jabber ID of the entity that you wish to put these settings on, it may be a full JID, bare JID, or just a domain.</li><li class="listitem"><p class="simpara">otr= Specifies setting for Off The Record mode. Available settings are:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem">approve The user MUST explicitly approve OTR communication.</li><li class="listitem">concede Communications MAY be OTR if requested by another user.</li><li class="listitem">forbid Communications MUST NOT be OTR.</li><li class="listitem">oppose Communications SHOULD NOT be OTR.</li><li class="listitem">prefer Communications SHOULD be OTR.</li><li class="listitem">require Communications MUST be OTR.</li></ul></div></li><li class="listitem"><p class="simpara">save= Specifies the portion of messages to archive, by default it is set to body.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem">body Archives only the items within the &lt;body/&gt; elements.</li><li class="listitem">message Archive the entire XML content of each message.</li><li class="listitem">stream Archive saves every byte of communication between server and client. (Not recommended, high resource use)</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara"><span class="strong"><strong>Optional Settings</strong></span></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">expire= Specifies after how many seconds should the server delete saved messages.</li></ul></div></li></ul></div></dd><dt><span class="term">&lt;method/&gt;</span></dt><dd><p class="simpara">This element specifies the user preference for available archiving methods.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara"><span class="strong"><strong>Required Attributes</strong></span></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p class="simpara">type= The type of archiving to set</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem">auto Preferences for use of automatic archiving on the user&#8217;s server.</li><li class="listitem">local Set to use local archiving on user&#8217;s machine or device.</li><li class="listitem">manual Preferences for use of manual archiving to the server.</li></ul></div></li><li class="listitem"><p class="simpara">use= Sets level of use for the type</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem">prefer The selected method should be used if it is available.</li><li class="listitem">concede This will be used if no other methods are available.</li><li class="listitem">forbid The associated method MUST not be used.</li></ul></div></li></ul></div></li></ul></div></dd></dl></div><p>Now that we have established settings, lets send a stanza changing a few of them:</p><pre class="programlisting">&lt;iq type='set' id='pref2'&gt;
  &lt;pref xmlns='urn:xmpp:archive'&gt;
    &lt;auto save='true' scope='global'/&gt;
    &lt;item jid='domain.com' otr='forbid' save='body'/&gt;
    &lt;method type='auto' use='prefer'/&gt;
    &lt;method type='local' use='forbid'/&gt;
    &lt;method type='manual' use='concede'/&gt;
  &lt;/pref&gt;
&lt;/iq&gt;</pre><p>This now sets archiving by default for all users on the domain.com server, forbids OTR, and prefers auto save method for archiving.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_manual_activation"></a>Manual Activation</h3></div></div></div><p>Turning on archiving requires a simple stanza which will turn on archiving for the use sending the stanza and using default settings.</p><pre class="programlisting">&lt;iq type='set' id='turnon'&gt;
  &lt;pref xmlns='urn:xmpp:archive'&gt;
    &lt;auto save='true'/&gt;
  &lt;/pref&gt;
&lt;/iq&gt;</pre><p>A sucessful result will yield this response from the server:</p><pre class="programlisting">&lt;iq type='result' to='user@domain.com' id='turnon'/&gt;</pre><p>Once this is turned on, incoming and outgoing messages from the user will be stored in tig_ma_msgs table in the database.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_automatic_activation_of_muc_messages"></a>Automatic Activation of MUC messages</h3></div></div></div><p>Enabling this feature allows MUC messages to be stored in the Message Archive repository and are added in the same way as for any other message. For this setting consider the MUC room JID, this will be the "user" that the messages will be archived with.  This is the same JID used for retrevial as well as sending to storage.   Archived MUC messages will be in the same format as normal archival messages with one exception, each message will have a &lt;name&gt; attribute attached which will be the room nick for the user that sent the message.
This feature is disabled by default.</p><p><span class="strong"><strong>NOTE:</strong></span> It is worth to mention that even if more than on user resources joins the same room and each resource will receive the same messages, then only a single message will be stored in Message Archiving repository.
It is also important to note that MUC messages are archived to user messages archive only when user is joined to MUC room. For example, if message was sent to room but it was not sent to particular user, it will not be archived.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_configuration_8"></a>Configuration</h4></div></div></div><p>Enabling archiving of MUC messages is done by adding one more line to your init.properties file. Along with defining comp-name and comp-class add this line:</p><pre class="programlisting">sess-man/plugins-conf/message-archive-xep-0136/store-muc-messages=value</pre><p>value may be one of the following values:
- user Allows value to be set on domain level by user if the domain level setting allows that. [what?]
- true Enables the feature for all users in every hosted domain. This cannot be overridden by settings for individual domains or users.
- false Disables the feature for all users in every hosted domain. This cannot be overridden by settings for individual domains or users.</p><p>To configure this setting for individual vhosts, you will need to execute a configuration command using one of the following settings:
- user Allows user to start this feature
- true Enables feature for users of the configured domain. Users will be unable to disable this feature.
- false Disables feature for users of the configured domain. Users will be unable to disable this feature.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_searching_for_messages"></a>Searching for Messages</h3></div></div></div><p>Tigase Message Archiving Component allows users to query for messages or collections that contain a string. A simple stanza sent to the message archive component will begin a search. For example, the following stanza requests a search for messages with "test failed" in the &lt;body&gt; element. <span class="strong"><strong>NOTE:</strong></span> Searches can <span class="strong"><strong>ONLY</strong></span> be conducted within &lt;body&gt; elements.</p><pre class="programlisting">&lt;query xmlns="http://tigase.org/protocol/archive#query"&gt;
    &lt;contains&gt;test failed&lt;/contains&gt;
&lt;/query&gt;</pre><p><span class="strong"><strong>This query element must be the child of a list or retrieve element.</strong></span></p><p>Search options include:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">with= Specify JID of user sending message</li><li class="listitem">from= Search from this time and date, Format: YYYY-MM-DDTHH:MM:SSZ Time is in 24h set to GMT</li><li class="listitem">end= Search until this time and date, Format: YYYY-MM-DDTHH:MM:SSZ Time is in 24h set to GMT</li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_example_queries"></a>Example queries</h4></div></div></div><p>Retrieving messages with "test failed" string with user <a class="link" href="mailto:juliet@capulet.com" target="_top">juliet@capulet.com</a> between 2014-01-01 00:00:00 and 2014-05-01 00:00:00</p><pre class="programlisting">&lt;iq type="get" id="query2"&gt;
    &lt;retrieve xmlns='urn:xmpp:archive'
        with='juliet@capulet.com'
        from='2014-01-01T00:00:00Z'
        end='2014-05-01T00:00:00Z'&gt;
          &lt;query xmlns="http://tigase.org/protocol/archive#query"&gt;
              &lt;contains&gt;test failed&lt;/contains&gt;
          &lt;/query&gt;
    &lt;/retrieve&gt;
&lt;/iq&gt;</pre><p>Retrieving collections containing messages with "test failed" string with user <a class="link" href="mailto:juliet@capulet.com" target="_top">juliet@capulet.com</a> between 2014-01-01 00:00:00 and 2014-05-01 00:00:00</p><pre class="programlisting">&lt;iq type="get" id="query2"&gt;
    &lt;list xmlns='urn:xmpp:archive'
        with='juliet@capulet.com'
        from='2014-01-01T00:00:00Z'
        end='2014-05-01T00:00:00Z'&gt;
          &lt;query xmlns="http://tigase.org/protocol/archive#query"&gt;
              &lt;contains&gt;test failed&lt;/contains&gt;
          &lt;/query&gt;
    &lt;/list&gt;
&lt;/iq&gt;</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_message_tagging_support"></a>Message Tagging Support</h3></div></div></div><p>Tigase now is able to support querying message archives based on tags created for the query.  Currently, Tigase can support the following tags to help seach through message archives:
- hashtag Words prefixed by a hash (#) are stored with a prefix and used as a tag, for example #Tigase
- mention Words prefixed by an at (@) are stored with a prefix and used as a tag, for example @Tigase</p><p><span class="strong"><strong>NOTE:</strong></span> Tags must be written in messages from users, they do not act as wildcards. To search for #Tigase, a message must have #Tigase in the &lt;body&gt; element.</p><p>This feature allows users to query and retrieve messages or collections from the archive that only contain one or more tags.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_activating_tagging"></a>Activating Tagging</h4></div></div></div><p>To enable this feature, the following line must be in the init.properties file (or may be added with Admin or Web UI)</p><pre class="programlisting">message-archiving/tags-support[B]=true</pre><p>Where message-archiving is the class name of the component.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_usage_4"></a>Usage</h4></div></div></div><p>To execute a request, the tags must be individual children elements of the retrieve or list element like the following request:</p><pre class="programlisting">&lt;query xmlns="http://tigase.org/protocol/archive#query"&gt;
    &lt;tag&gt;#People&lt;/tag&gt;
    &lt;tag&gt;@User1&lt;/tag&gt;
&lt;/query&gt;</pre><p>You may also specify specific senders, and limit the time and date that you wish to search through to keep the resulting list smaller.  That can be accomplished by adding more fields to the retrieve element such as 'with', 'from', and 'end' . Take a look at the below example:</p><pre class="programlisting">&lt;iq type="get" id="query2"&gt;
    &lt;retrieve xmlns='urn:xmpp:archive'
        with='juliet@capulet.com'
        from='2014-01-01T00:00:00Z'
        end='2014-05-01T00:00:00Z'&gt;
          &lt;query xmlns="http://tigase.org/protocol/archive#query"&gt;
              &lt;tag&gt;#People&lt;/tag&gt;
              &lt;tag&gt;@User1&lt;/tag&gt;
          &lt;/query&gt;
    &lt;/retrieve&gt;
&lt;/iq&gt;</pre><p>This stanza is requesting to retrieve messages tagged with @User1 and #people from chats with the user <a class="link" href="mailto:juliet@capulet.com" target="_top">juliet@capulet.com</a> between January 1st, 2014 at 00:00 to May 1st, 2014 at 00:00.</p><p><span class="strong"><strong>NOTE:</strong></span> All times are in Zulu or GMT on a 24h clock.</p><p>You can add as many tags as you wish, but each one is an <span class="strong"><strong>AND</strong></span> statement; so the more tags you include, the smaller the results.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_tag_searching"></a>Tag Searching</h4></div></div></div><p>You can also retrieve a list of Tags that have already been used and are stored in the message archive. You can search for exact or a partial of the tag or mention.  The following request is searching for tags that are 'like' #test, in this case any tags with #test present will show in a list.</p><pre class="programlisting">&lt;iq type="set" id="tagquery"&gt;
    &lt;tags xmlns="http://tigase.org/protocol/archive#query" like="#test"/&gt;
&lt;/iq&gt;</pre><p>The result will return tags with #test in them:</p><pre class="programlisting">&lt;iq type="result" id="tagquery"&gt;
    &lt;tags xmlns="http://tigase.org/protocol/archive#query" like="#test"&gt;
        &lt;tag&gt;#test1&lt;/tag&gt;
        &lt;tag&gt;#test123&lt;/tag&gt;
        &lt;tag&gt;#testwin&lt;/tag&gt;
        &lt;set xmlns="http://jabber.org/protocol/rsm"&gt;
             &lt;first index='0'&gt;0&lt;/first&gt;
             &lt;last&gt;2&lt;/last&gt;
             &lt;count&gt;3&lt;/count&gt;
        &lt;/set&gt;
    &lt;/tags&gt;
&lt;/iq&gt;</pre><p>You may retrieve a list of tags or mentions by using just the # or @ symbols in the like= field.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="maPurging"></a>Purging Information from Message Archive</h3></div></div></div><p>This feature allows for automatic removal of entries older than a configured number of days from the Message Archive. It is designed to clean up database and keep its size within reasonable boundaries.</p><p>There are 4 settings available for this feature:
To enable the feature:
message-archive/remove-expired-messages[B]=true</p><p>This setting changes the initial delay after the server is started to begin removing old entries.  In other words, MA purging will not take place until the specified time after the server starts.  Default setting is PT1H, or one hour.
message-archive/remove-expired-messages-delay=PT2H</p><p>This setting sets how long MA purging will wait between passes to check for and remove old entries. Default setting is P1D which is once a day.
message-archive/remove-expired-messages-period=PT2D</p><p><span class="strong"><strong>NOTE</strong></span> that these commands are also compatible with unified-archive component, just replace message with unified.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_configuration_of_number_of_days_in_vhost"></a>Configuration of number of days in VHost</h4></div></div></div><p>VHost holds a setting that determines how long a message needs to be in archive for it to be considered old and removed.  This can be set independently per Vhost.  This setting can be modified by either using the HTTP admin, or the update item execution in adhoc command.</p><p>Command-line utility
Sets after how many days message should be removed - by default we use 24 hours. So if entry is older than 24 hours then it will be removed, ie. entry from yesterday from 10:11 will be removed after 10:11 after next execution of purge.
This configuration is done by execution of Update item configuration adhoc command of vhost-man component, where you should select domain for which messages should be removed and then in field XEP-0136 - retention type select value Number of days and in field XEP-0136 - retention period (in days) enter number of days after which events should be removed from UA.</p><p>In adhoc select domain for which messages should be removed and then in field XEP-0136 - retention type select value Number of days and in field XEP-0136 - retention period (in days) enter number of days after which events should be removed from UA.</p><p>In HTTP UI select Other, then Update Item Configuration (Vhost-man), select the domain, and from there you can set XEP-0136 retention type, and set number of days at XEP-0136 retention period (in days).</p><p>Value of remove-expired-messages-delay and remove-expired-messages-period is in format described at Duration.parse() in Java documentation.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_tigase_http_api.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="loadComponent.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="amp0079.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Tigase HTTP API&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Advanced Message Processing - AMP XEP-0079</td></tr></table></div></body></html>